# 蛻ｩ逕ｨ閠・ュ蝣ｱ邱ｨ髮・ｩ溯・ - 繝・せ繝域焔鬆・
> **逶ｮ逧・*: 蛻ｩ逕ｨ閠・ュ蝣ｱ邱ｨ髮・ｩ溯・・亥倶ｺｺ諠・ｱ + 蛹ｻ逋ら噪繧ｱ繧｢ + 讌ｽ隕ｳ繝ｭ繝・け + 逶｣譟ｻ繝ｭ繧ｰ・峨・蜍穂ｽ懃｢ｺ隱・ 
> **蟇ｾ雎｡**: 繝ｭ繝ｼ繧ｫ繝ｫ髢狗匱迺ｰ蠅・+ Vercel 譛ｬ逡ｪ迺ｰ蠅・ 
> **驥崎ｦ・*: 蛟倶ｺｺ諠・ｱ菫晁ｭｷ繝昴Μ繧ｷ繝ｼ縺ｫ蠕薙＞縲・幕逋ｺ迺ｰ蠅・〒縺ｯ蛹ｿ蜷阪ョ繝ｼ繧ｿ縺ｮ縺ｿ菴ｿ逕ｨ

---

## 蜑肴署譚｡莉ｶ

### 繝ｭ繝ｼ繧ｫ繝ｫ迺ｰ蠅・- Supabase 繝ｭ繝ｼ繧ｫ繝ｫ迺ｰ蠅・′襍ｷ蜍輔＠縺ｦ縺・ｋ縺薙→・・npx supabase start`・・- migration 縺碁←逕ｨ貂医∩縺ｧ縺ゅｋ縺薙→・・npx supabase db reset` 縺ｾ縺溘・ `npx supabase db push`・・- 髢狗匱繧ｵ繝ｼ繝舌・縺瑚ｵｷ蜍輔＠縺ｦ縺・ｋ縺薙→・・pnpm dev`・・
### 譛ｬ逡ｪ迺ｰ蠅・- Vercel 縺ｫ繝・・繝ｭ繧､貂医∩縺ｧ縺ゅｋ縺薙→
- Supabase 譛ｬ逡ｪ迺ｰ蠅・↓ migration 縺碁←逕ｨ貂医∩縺ｧ縺ゅｋ縺薙→
- 迺ｰ蠅・､画焚縺梧ｭ｣縺励￥險ｭ螳壹＆繧後※縺・ｋ縺薙→・・NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY`・・
---

## 繝・せ繝医す繝翫Μ繧ｪ

### 1. 蛟倶ｺｺ諠・ｱ邱ｨ髮・・蝓ｺ譛ｬ蜍穂ｽ懶ｼ医Ο繝ｼ繧ｫ繝ｫ・・
#### 謇矩・1. 繝悶Λ繧ｦ繧ｶ縺ｧ `http://dev-app.local:3000` 繧帝幕縺・2. 繝ｭ繧ｰ繧､繝ｳ逕ｻ髱｢縺ｧ隱崎ｨｼ・・upabase Auth 縺ｾ縺溘・蛹ｿ蜷阪い繧ｯ繧ｻ繧ｹ・・3. `http://dev-app.local:3000/services/life-care/users/AT` 繧帝幕縺擾ｼ亥茜逕ｨ閠・ｩｳ邏ｰ繝壹・繧ｸ・・4. "白 隧ｳ邏ｰ諠・ｱ繧堤ｷｨ髮・ 繝懊ち繝ｳ繧偵け繝ｪ繝・け
5. 繝繧､繧｢繝ｭ繧ｰ縺碁幕縺上％縺ｨ繧堤｢ｺ隱・
#### 遒ｺ隱埼・岼
- [ ] 繝繧､繧｢繝ｭ繧ｰ縺梧ｭ｣縺励￥陦ｨ遉ｺ縺輔ｌ繧・- [ ] 譌｢蟄倥・ `display_name` 縺瑚｡ｨ遉ｺ縺輔ｌ繧具ｼ井ｾ・ "AT"・・- [ ] 蛟倶ｺｺ諠・ｱ繝輔ぅ繝ｼ繝ｫ繝峨′遨ｺ谺・〒陦ｨ遉ｺ縺輔ｌ繧具ｼ磯幕逋ｺ迺ｰ蠅・〒縺ｯ譛ｪ蜈･蜉幢ｼ・- [ ] 蛹ｻ逋ら噪繧ｱ繧｢繝√ぉ繝・け繝懊ャ繧ｯ繧ｹ縺瑚｡ｨ遉ｺ縺輔ｌ繧具ｼ育ｵ檎ｮ｡譬・､翫∝精蠑輔・・邏蜷ｸ蜈･縲∽ｺｺ蟾･蜻ｼ蜷ｸ蝎ｨ縲∫匱菴懷ｯｾ蠢懶ｼ・
#### 譛溷ｾ・ｵ先棡
笨・繝繧､繧｢繝ｭ繧ｰ縺碁幕縺阪√ヵ繧ｩ繝ｼ繝繝輔ぅ繝ｼ繝ｫ繝峨′豁｣縺励￥陦ｨ遉ｺ縺輔ｌ繧・
---

### 2. 蛹ｿ蜷阪ョ繝ｼ繧ｿ縺ｧ縺ｮ菫晏ｭ假ｼ磯幕逋ｺ迺ｰ蠅・ｼ・
#### 謇矩・1. 荳願ｨ倥ム繧､繧｢繝ｭ繧ｰ縺ｧ莉･荳九ｒ蜈･蜉・
   - `display_name`: "繝・せ繝亥茜逕ｨ閠・"・亥諺蜷搾ｼ・   - `full_name`: **遨ｺ谺・・縺ｾ縺ｾ**・磯幕逋ｺ迺ｰ蠅・〒縺ｯ螳溷錐繧貞・繧後↑縺・ｼ・   - `birthday`: "2000-01-01"
   - `gender`: "male"
   - `medical_care_detail.tube_feeding`: 繝√ぉ繝・け
   - `medical_care_detail.tube_feeding_detail`: "邨碁ｼｻ邨檎ｮ｡譬・､・
2. "菫晏ｭ・ 繝懊ち繝ｳ繧偵け繝ｪ繝・け
3. 繝医・繧ｹ繝磯夂衍縺瑚｡ｨ遉ｺ縺輔ｌ繧九％縺ｨ繧堤｢ｺ隱・
#### 遒ｺ隱埼・岼
- [ ] 繝医・繧ｹ繝磯夂衍縺・"蛻ｩ逕ｨ閠・ュ蝣ｱ繧呈峩譁ｰ縺励∪縺励◆" 縺ｨ陦ｨ遉ｺ縺輔ｌ繧・- [ ] 繝壹・繧ｸ縺後Μ繝輔Ξ繝・す繝･縺輔ｌ縲∬｡ｨ遉ｺ蜷阪′ "繝・せ繝亥茜逕ｨ閠・" 縺ｫ譖ｴ譁ｰ縺輔ｌ繧・- [ ] 繝悶Λ繧ｦ繧ｶ縺ｮ Developer Tools 竊・Network 繧ｿ繝悶〒 `/api/care-receivers/AT` 縺ｮ PUT 繝ｪ繧ｯ繧ｨ繧ｹ繝医ｒ遒ｺ隱・- [ ] Response body 縺ｫ `version` 縺悟性縺ｾ繧後※縺・ｋ

#### 譛溷ｾ・ｵ先棡
笨・繝・・繧ｿ縺梧ｭ｣蟶ｸ縺ｫ菫晏ｭ倥＆繧後√・繝ｼ繧ｸ縺梧峩譁ｰ縺輔ｌ繧・
---

### 3. 繝ｭ繧ｰ蜃ｺ蜉帷ｦ∵ｭ｢縺ｮ遒ｺ隱・
#### 謇矩・1. 繝悶Λ繧ｦ繧ｶ縺ｮ Developer Tools 竊・Console 繧ｿ繝悶ｒ髢九￥
2. 蛻ｩ逕ｨ閠・ュ蝣ｱ邱ｨ髮・ム繧､繧｢繝ｭ繧ｰ繧帝幕縺・3. "菫晏ｭ・ 繝懊ち繝ｳ繧偵け繝ｪ繝・け
4. Console 縺ｫ `full_name`, `address`, `phone`, `emergency_contact` 縺ｪ縺ｩ縺悟・蜉帙＆繧後※縺・↑縺・％縺ｨ繧堤｢ｺ隱・
#### 遒ｺ隱埼・岼
- [ ] Console 縺ｫ蛟倶ｺｺ諠・ｱ縺悟・蜉帙＆繧後※縺・↑縺・- [ ] Network 繧ｿ繝悶・ Response Preview 縺ｧ `full_name` 縺ｪ縺ｩ縺悟性縺ｾ繧後※縺・ｋ・・PI 繝ｬ繧ｹ繝昴Φ繧ｹ縺ｫ縺ｯ蜷ｫ縺ｾ繧後ｋ・・- [ ] Console 繝ｭ繧ｰ縺ｫ縺ｯ `sanitizedResponse` 縺ｮ縺ｿ縺悟・蜉帙＆繧後※縺・ｋ・亥倶ｺｺ諠・ｱ繧帝勁螟厄ｼ・
#### 譛溷ｾ・ｵ先棡
笨・繝ｭ繧ｰ縺ｫ蛟倶ｺｺ諠・ｱ縺悟・蜉帙＆繧後★縲√し繝九ち繧､繧ｺ縺輔ｌ縺溘Ξ繧ｹ繝昴Φ繧ｹ縺ｮ縺ｿ縺瑚｡ｨ遉ｺ縺輔ｌ繧・
---

### 4. RLS 縺ｫ繧医ｋ蛟倶ｺｺ諠・ｱ菫晁ｭｷ・・upabase SQL Editor・・
#### 謇矩・1. Supabase Dashboard 竊・SQL Editor 繧帝幕縺・2. 莉･荳九・ SQL 繧貞ｮ溯｡・
   ```sql
   SET ROLE anon;  -- 隱崎ｨｼ蜑阪・繝ｦ繝ｼ繧ｶ繝ｼ繝ｭ繝ｼ繝ｫ
   SELECT full_name, address, phone FROM care_receivers WHERE code = 'AT';
   ```
3. 螳溯｡檎ｵ先棡繧堤｢ｺ隱・
#### 遒ｺ隱埼・岼
- [ ] 0莉ｶ霑泌唆縺輔ｌ繧具ｼ・LS 縺ｧ諡貞凄縺輔ｌ繧具ｼ・- [ ] 繧ｨ繝ｩ繝ｼ繝｡繝・そ繝ｼ繧ｸ縺瑚｡ｨ遉ｺ縺輔ｌ繧具ｼ井ｾ・ "permission denied for table care_receivers"・・
#### 譛溷ｾ・ｵ先棡
笨・RLS 繝昴Μ繧ｷ繝ｼ縺梧ｭ｣縺励￥蜍穂ｽ懊＠縲∥non 繝ｭ繝ｼ繝ｫ縺九ｉ蛟倶ｺｺ諠・ｱ縺ｫ繧｢繧ｯ繧ｻ繧ｹ縺ｧ縺阪↑縺・
---

### 5. 讌ｽ隕ｳ繝ｭ繝・け - 蜷梧凾邱ｨ髮・・讀懷・・・繝悶Λ繧ｦ繧ｶ・・
#### 謇矩・1. **繝悶Λ繧ｦ繧ｶA**: `http://dev-app.local:3000/services/life-care/users/AT` 繧帝幕縺・2. **繝悶Λ繧ｦ繧ｶB**: 蜷後§ URL 繧貞挨縺ｮ繝悶Λ繧ｦ繧ｶ・医∪縺溘・ Incognito 繝｢繝ｼ繝会ｼ峨〒髢九￥
3. **繝悶Λ繧ｦ繧ｶA**: "白 隧ｳ邏ｰ諠・ｱ繧堤ｷｨ髮・ 竊・`display_name` 繧・"繝・せ繝亥茜逕ｨ閠・" 縺ｫ螟画峩 竊・"菫晏ｭ・
4. **繝悶Λ繧ｦ繧ｶB**: "白 隧ｳ邏ｰ諠・ｱ繧堤ｷｨ髮・ 竊・`display_name` 繧・"繝・せ繝亥茜逕ｨ閠・" 縺ｫ螟画峩 竊・"菫晏ｭ・

#### 遒ｺ隱埼・岼
- [ ] 繝悶Λ繧ｦ繧ｶA 縺ｮ菫晏ｭ倥・謌仙粥縺吶ｋ・医ヨ繝ｼ繧ｹ繝磯夂衍陦ｨ遉ｺ・・- [ ] 繝悶Λ繧ｦ繧ｶB 縺ｮ菫晏ｭ倥・螟ｱ謨励☆繧具ｼ・09 Conflict・・- [ ] 繝悶Λ繧ｦ繧ｶB 縺ｧ AlertDialog 縺瑚｡ｨ遉ｺ縺輔ｌ繧・ "笞・・莉悶・繝ｦ繝ｼ繧ｶ繝ｼ縺悟・縺ｫ譖ｴ譁ｰ縺励※縺・∪縺・
- [ ] "譛譁ｰ繝・・繧ｿ繧貞・隱ｭ縺ｿ霎ｼ縺ｿ" 繝懊ち繝ｳ繧偵け繝ｪ繝・け縺吶ｋ縺ｨ縲√ヶ繝ｩ繧ｦ繧ｶB 縺ｮ繝輔か繝ｼ繝縺梧怙譁ｰ繝・・繧ｿ・・繝・せ繝亥茜逕ｨ閠・"・峨↓譖ｴ譁ｰ縺輔ｌ繧・
#### 譛溷ｾ・ｵ先棡
笨・讌ｽ隕ｳ繝ｭ繝・け縺梧ｭ｣縺励￥蜍穂ｽ懊＠縲∫ｫｶ蜷医′讀懷・縺輔ｌ繧・
---

### 6. 逶｣譟ｻ繝ｭ繧ｰ縺ｮ遒ｺ隱搾ｼ・upabase Table Editor・・
#### 謇矩・1. Supabase Dashboard 竊・Table Editor 竊・`care_receiver_audits` 繝・・繝悶Ν繧帝幕縺・2. 譛譁ｰ縺ｮ繝ｬ繧ｳ繝ｼ繝峨ｒ遒ｺ隱・
#### 遒ｺ隱埼・岼
- [ ] `care_receiver_id` 縺悟ｯｾ雎｡縺ｮ蛻ｩ逕ｨ閠・ｼ・T・峨・ UUID 縺ｨ荳閾ｴ縺吶ｋ
- [ ] `changed_fields` 縺ｫ螟画峩縺輔ｌ縺溘ヵ繧｣繝ｼ繝ｫ繝牙錐縺瑚ｨ倬鹸縺輔ｌ縺ｦ縺・ｋ・井ｾ・ `["display_name", "medical_care_detail"]`・・- [ ] `changed_fields` 縺ｫ蛟倶ｺｺ諠・ｱ縺ｮ**蛟､**縺ｯ蜷ｫ縺ｾ繧後※縺・↑縺・ｼ医く繝ｼ蜷阪・縺ｿ・・- [ ] `changed_at` 縺梧怙譁ｰ縺ｮ繧ｿ繧､繝繧ｹ繧ｿ繝ｳ繝励〒縺ゅｋ
- [ ] `changed_by` 縺檎樟蝨ｨ縺ｮ隱崎ｨｼ貂医∩繝ｦ繝ｼ繧ｶ繝ｼ縺ｮ UUID 縺ｧ縺ゅｋ

#### 譛溷ｾ・ｵ先棡
笨・逶｣譟ｻ繝ｭ繧ｰ縺梧ｭ｣縺励￥險倬鹸縺輔ｌ縲∝倶ｺｺ諠・ｱ縺ｮ蛟､縺ｯ蜷ｫ縺ｾ繧後※縺・↑縺・
---

### 7. 譛ｬ逡ｪ迺ｰ蠅・〒縺ｮ螳溷錐蜈･蜉幢ｼ・ercel 繝・・繝ｭ繧､蠕後・縺ｿ・・
#### 謇矩・1. Vercel 縺ｫ繝・・繝ｭ繧､縺輔ｌ縺滓悽逡ｪ迺ｰ蠅・ｒ髢九￥・井ｾ・ `https://juushin-care-xxx.vercel.app`・・2. 繝ｭ繧ｰ繧､繝ｳ 竊・蛻ｩ逕ｨ閠・ｩｳ邏ｰ繝壹・繧ｸ 竊・"白 隧ｳ邏ｰ諠・ｱ繧堤ｷｨ髮・
3. **譛ｬ逡ｪ迺ｰ蠅・・縺ｿ**縺ｧ莉･荳九ｒ蜈･蜉・
   - `full_name`: "螻ｱ逕ｰ 螟ｪ驛・・亥ｮ溷錐・・   - `address`: "譚ｱ莠ｬ驛ｽ縲・・玄縲・・-2-3"
   - `phone`: "03-1234-5678"
   - `emergency_contact`: "邱頑･騾｣邨｡蜈・ 090-xxxx-xxxx"
4. "菫晏ｭ・ 繝懊ち繝ｳ繧偵け繝ｪ繝・け

#### 遒ｺ隱埼・岼
- [ ] 繝・・繧ｿ縺梧ｭ｣蟶ｸ縺ｫ菫晏ｭ倥＆繧後ｋ
- [ ] 繝悶Λ繧ｦ繧ｶ縺ｮ Console 縺ｫ蛟倶ｺｺ諠・ｱ縺悟・蜉帙＆繧後※縺・↑縺・- [ ] Supabase Table Editor 縺ｧ `care_receivers` 繝・・繝悶Ν繧堤｢ｺ隱阪＠縲～full_name`, `address`, `phone` 縺御ｿ晏ｭ倥＆繧後※縺・ｋ縺薙→繧堤｢ｺ隱・- [ ] 髢狗匱迺ｰ蠅・ｼ医Ο繝ｼ繧ｫ繝ｫ・峨〒縺ｯ蠑輔″邯壹″蛹ｿ蜷阪ョ繝ｼ繧ｿ縺ｮ縺ｿ繧剃ｽｿ逕ｨ縺吶ｋ

#### 譛溷ｾ・ｵ先棡
笨・譛ｬ逡ｪ迺ｰ蠅・〒縺ｮ縺ｿ螳溷錐縺悟・蜉帙＆繧後・幕逋ｺ迺ｰ蠅・〒縺ｯ蛹ｿ蜷阪ョ繝ｼ繧ｿ縺ｮ縺ｿ縺御ｽｿ逕ｨ縺輔ｌ繧・
---

## 蝗槫ｸｰ繝・せ繝茨ｼ域里蟄俶ｩ溯・縺ｸ縺ｮ蠖ｱ髻ｿ遒ｺ隱搾ｼ・
### 1. 譌｢蟄倥・ "笨擾ｸ・邁｡譏鍋ｷｨ髮・ 繝懊ち繝ｳ
- [ ] 譌｢蟄倥・邁｡譏鍋ｷｨ髮・ム繧､繧｢繝ｭ繧ｰ縺梧ｭ｣蟶ｸ縺ｫ蜍穂ｽ懊☆繧・- [ ] `display_name` 縺ｮ譖ｴ譁ｰ縺梧ｭ｣蟶ｸ縺ｫ蜿肴丐縺輔ｌ繧・
### 2. 繧ｱ繝ｼ繧ｹ險倬鹸讖溯・
- [ ] `/services/life-care/users/AT/case-records` 縺梧ｭ｣蟶ｸ縺ｫ陦ｨ遉ｺ縺輔ｌ繧・- [ ] 繧ｱ繝ｼ繧ｹ險倬鹸縺ｮ菫晏ｭ倥′豁｣蟶ｸ縺ｫ蜍穂ｽ懊☆繧・
### 3. A4 險倬鹸繧ｷ繝ｼ繝・- [ ] 蛻ｩ逕ｨ閠・ｩｳ邏ｰ繝壹・繧ｸ縺ｮ "A4險倬鹸繧ｷ繝ｼ繝・ 繧ｻ繧ｯ繧ｷ繝ｧ繝ｳ縺梧ｭ｣蟶ｸ縺ｫ陦ｨ遉ｺ縺輔ｌ繧・- [ ] `display_name` 縺梧ｭ｣縺励￥蜿肴丐縺輔ｌ繧具ｼ亥ｮ溷錐縺ｧ縺ｯ縺ｪ縺丞諺蜷崎｡ｨ遉ｺ・・
---

## 繝医Λ繝悶Ν繧ｷ繝･繝ｼ繝・ぅ繝ｳ繧ｰ

### 繧ｨ繝ｩ繝ｼ: "permission denied for table care_receivers"
**蜴溷屏**: RLS 繝昴Μ繧ｷ繝ｼ縺梧怏蜉ｹ蛹悶＆繧後※縺翫ｊ縲∬ｪ崎ｨｼ縺輔ｌ縺ｦ縺・↑縺・Θ繝ｼ繧ｶ繝ｼ縺後い繧ｯ繧ｻ繧ｹ縺ｧ縺阪↑縺・ 
**蟇ｾ蜃ｦ**: Supabase Auth 縺ｧ繝ｭ繧ｰ繧､繝ｳ縺励※縺九ｉ蜀榊ｺｦ繧｢繧ｯ繧ｻ繧ｹ

### 繧ｨ繝ｩ繝ｼ: "409 Conflict"・亥ｸｸ縺ｫ逋ｺ逕溘☆繧具ｼ・**蜴溷屏**: `version` 繧ｫ繝ｩ繝縺梧ｭ｣縺励￥騾∽ｿ｡縺輔ｌ縺ｦ縺・↑縺・√∪縺溘・ DB 繝医Μ繧ｬ繝ｼ縺悟虚菴懊＠縺ｦ縺・↑縺・ 
**蟇ｾ蜃ｦ**: 
1. Supabase SQL Editor 縺ｧ莉･荳九ｒ螳溯｡後＠縲√ヨ繝ｪ繧ｬ繝ｼ縺悟ｭ伜惠縺吶ｋ縺狗｢ｺ隱・
   ```sql
   SELECT * FROM pg_trigger WHERE tgname = 'increment_care_receiver_version';
   ```
2. 繝医Μ繧ｬ繝ｼ縺悟ｭ伜惠縺励↑縺・ｴ蜷医［igration 繧貞・螳溯｡・ `npx supabase db reset`

### 繧ｨ繝ｩ繝ｼ: Console 縺ｫ蛟倶ｺｺ諠・ｱ縺悟・蜉帙＆繧後ｋ
**蜴溷屏**: API 繝ｬ繧ｹ繝昴Φ繧ｹ縺ｧ `sanitizedResponse` 繧剃ｽｿ逕ｨ縺励※縺・↑縺・ 
**蟇ｾ蜃ｦ**: `app/api/care-receivers/[id]/route.ts` 縺ｮ GET/PUT 繧ｨ繝ｳ繝峨・繧､繝ｳ繝医〒 `sanitizedResponse` 繧剃ｽｿ逕ｨ縺励※縺・ｋ縺薙→繧堤｢ｺ隱・
---

## 縺ｾ縺ｨ繧・
- **髢狗匱迺ｰ蠅・*: 蛹ｿ蜷阪ョ繝ｼ繧ｿ縺ｮ縺ｿ菴ｿ逕ｨ縲∝倶ｺｺ諠・ｱ縺ｯ繝ｭ繧ｰ縺ｫ蜃ｺ縺輔↑縺・ヽLS 縺ｧ菫晁ｭｷ
- **譛ｬ逡ｪ迺ｰ蠅・*: 螳溷錐蜈･蜉帛庄閭ｽ縲∽ｽ・＠繝ｭ繧ｰ縺ｫ縺ｯ蜃ｺ縺輔↑縺・- **讌ｽ隕ｳ繝ｭ繝・け**: 蜷梧凾邱ｨ髮・ｒ讀懷・縺励・09 UI 縺ｧ荳∝ｯｧ縺ｫ譯亥・
- **逶｣譟ｻ繝ｭ繧ｰ**: 螟画峩縺輔ｌ縺溘ヵ繧｣繝ｼ繝ｫ繝牙錐縺ｮ縺ｿ險倬鹸縲∝､縺ｯ蜷ｫ繧√↑縺・
蜈ｨ縺ｦ縺ｮ繝・せ繝医こ繝ｼ繧ｹ縺娯怛縺ｧ縺ゅｌ縺ｰ縲∝茜逕ｨ閠・ュ蝣ｱ邱ｨ髮・ｩ溯・縺ｯ豁｣蟶ｸ縺ｫ蜍穂ｽ懊＠縺ｦ縺・∪縺吶・
